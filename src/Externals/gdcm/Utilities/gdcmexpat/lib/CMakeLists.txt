
SET(EXPAT_SRCS
  xmlparse.c
  xmltok.c
  xmlrole.c
)

# for windows add the .def and .rc files to the source list if building shared libs
IF(WIN32)
  IF(BUILD_SHARED_LIBS)
    SET(EXPAT_DLL 1)
    IF(NOT UNIX)
      IF(NOT BORLAND)
        IF(NOT MINGW)
          SET(EXPAT_SRCS ${EXPAT_SRCS} libexpat.def )
        ENDIF(NOT MINGW)
      ENDIF(NOT BORLAND) 
    ENDIF(NOT UNIX)   
  ENDIF(BUILD_SHARED_LIBS)
ENDIF(WIN32)

ADD_LIBRARY(${EXPAT_LIBRARY_NAME} ${EXPAT_SRCS})
SET_TARGET_PROPERTIES(${EXPAT_LIBRARY_NAME} PROPERTIES ${EXPAT_LIBRARY_PROPERTIES})

IF(CMAKE_COMPILER_IS_GNUCC)
  SET_TARGET_PROPERTIES(${EXPAT_LIBRARY_NAME}
                        PROPERTIES
                        COMPILE_FLAGS "-w")
ENDIF(CMAKE_COMPILER_IS_GNUCC)

IF(WIN32)
  SET_TARGET_PROPERTIES(${EXPAT_LIBRARY_NAME}
                        PROPERTIES
                        COMPILE_FLAGS "-W0 -wd4244 -wd4267 -wd4101 -wd4005")
ENDIF(WIN32)

IF(NOT EXPAT_INSTALL_NO_LIBRARIES)
  INSTALL(TARGETS ${EXPAT_LIBRARY_NAME}
    EXPORT GDCMTargets
    RUNTIME DESTINATION ${EXPAT_INSTALL_BIN_DIR} COMPONENT Applications
    LIBRARY DESTINATION ${EXPAT_INSTALL_LIB_DIR} COMPONENT Libraries
    ARCHIVE DESTINATION ${EXPAT_INSTALL_LIB_DIR} COMPONENT Development
  ${CPACK_NAMELINK_TYPE}
  )
ENDIF(NOT EXPAT_INSTALL_NO_LIBRARIES)
